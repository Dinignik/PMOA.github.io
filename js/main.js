function applySystemTheme(){let e=window.matchMedia("(prefers-color-scheme: dark)").matches;e?document.documentElement.setAttribute("data-theme","dark"):document.documentElement.setAttribute("data-theme","light")}AOS.init(),document.getElementById("contact-form").addEventListener("submit",function(e){e.preventDefault();let t=this,o=document.getElementById("form-response");o.innerHTML="",t.querySelector('button[type="submit"]').disabled=!0;let l=new FormData(t),n={};l.forEach((e,t)=>n[t]=e),fetch("https://formspree.io/f/mldlqjyk",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then(e=>{if(e.ok)o.innerHTML=`
        <div class="alert alert-success">
          Форма успешно отправлена! Мы свяжемся с вами в ближайшее время.
        </div>
      `,t.reset();else throw Error("Ошибка отправки формы")}).catch(e=>{o.innerHTML=`
      <div class="alert alert-danger">
        Произошла ошибка при отправке формы. Пожалуйста, попробуйте позже.
      </div>
    `}).finally(()=>{t.querySelector('button[type="submit"]').disabled=!1})});const toggleTheme=()=>{let e=document.documentElement;e.dataset.theme="dark"===e.dataset.theme?"light":"dark",localStorage.setItem("theme",e.dataset.theme),updateChartColors(),updateImagesByTheme()};function updateImagesByTheme(){let e="dark"===document.documentElement.getAttribute("data-theme"),t=document.querySelectorAll("img[data-light-src][data-dark-src]");t.forEach(t=>{e?t.src=t.getAttribute("data-dark-src"):t.src=t.getAttribute("data-light-src")})}applySystemTheme(),updateImagesByTheme(),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{e.matches?document.documentElement.setAttribute("data-theme","dark"):document.documentElement.setAttribute("data-theme","light"),updateImagesByTheme()}),(()=>{let e=localStorage.getItem("theme");e&&(document.documentElement.dataset.theme=e,updateImagesByTheme())})();const dots=document.querySelectorAll(".nav-dots button"),sections=[...dots].map(e=>document.querySelector(e.dataset.target)),contactSection=document.getElementById("contact"),io=new IntersectionObserver(e=>{e.forEach(e=>{let t=document.querySelector(`[data-target="#${e.target.id}"]`);e.isIntersecting&&(dots.forEach(e=>e.classList.remove("active")),t&&t.classList.add("active"))})},{threshold:.4});sections.forEach(e=>io.observe(e));const scrollToSection=e=>{document.querySelector(e).scrollIntoView({behavior:"smooth"})};document.addEventListener("DOMContentLoaded",()=>{let e=document.querySelectorAll("#global-parallax-bg .parallax-shape");function t(){let t=window.scrollY;e.forEach((e,o)=>{let l=.12+.05*o;e.style.transform=`translate(${t*l*((o%2?1:-1)*.25)}px, ${-t*l}px)`})}let o=!1;window.addEventListener("scroll",()=>{o||(window.requestAnimationFrame(()=>{t(),o=!1}),o=!0)}),t(),new Swiper(".clients-swiper",{slidesPerView:1,spaceBetween:20,breakpoints:{768:{slidesPerView:2},992:{slidesPerView:3}},pagination:{el:".clients-swiper .swiper-pagination",clickable:!0},navigation:{nextEl:".clients-swiper .swiper-button-next",prevEl:".clients-swiper .swiper-button-prev"}}),document.addEventListener("aos:in",({detail:e})=>{e.matches(".events-swiper")&&new Swiper(".events-swiper",{loop:!0,slidesPerView:"auto",spaceBetween:20,autoplay:{delay:1,disableOnInteraction:!1,pauseOnMouseEnter:!1},speed:6e3,allowTouchMove:!0})})}),AOS.init({once:!0,duration:800}),window.addEventListener("scroll",function(){let e=document.querySelector(".scroll-hint1");e&&(e.style.opacity=window.scrollY>50?"0":"1")}),document.querySelector(".scroll-hint1").addEventListener("click",function(e){e.preventDefault(),window.scrollBy({top:.8*window.innerHeight,behavior:"smooth"})});let scrollTriggered=!1;function handleScroll(){if(!scrollTriggered&&window.scrollY>0){let e=document.getElementById("uslugi");e.scrollIntoView({behavior:"smooth",block:"start"}),scrollTriggered=!0,window.removeEventListener("scroll",handleScroll)}}window.addEventListener("scroll",handleScroll,{passive:!0});let openCount=0;document.querySelectorAll("#servisi .collapse").forEach(e=>{e.addEventListener("show.bs.collapse",()=>{let t=e.closest(".col");t.style.alignSelf="flex-start",1==++openCount&&(document.querySelector("#servisi .row").style.alignItems="flex-start")}),e.addEventListener("hide.bs.collapse",()=>{let t=e.closest(".col");setTimeout(()=>{t.style.removeProperty("align-self")},300),0==--openCount&&setTimeout(()=>{document.querySelector("#servisi .row").style.alignItems="stretch"},300)})}),document.addEventListener("DOMContentLoaded",function(){let e=[{title:"Наличие методологии",options:["Глоссарий по проектной деятельности","Положение о системе управления проектами","Положение о проектном офисе","Положение об организационно-ролевой структуре","Политика управления рисками","Положение об основных процессах управления проектами","Методика управления изменениями"]},{title:"Формализованность бизнес-процессов",options:["Процессы управления программами","Процессы управления портфелями проектов","Процессы управления проектами"]},{title:"Организационная структура",options:["Существует отдельно выделенное подразделение - Проектный офис или подразделение, выполняющее его функции"]},{title:"Персонал",options:["Действует система мотивации проектных команд","В организации имеются сертифицированные в области проектного управления специалисты","Действует система непрерывного обучения персонала (обучение/ повышения квалификации, сертификация)","Есть план обучения персонала проектному управлению"]},{title:"Контроль и аудит",options:["Регулярная работа Проектного комитета","Система контроля и мониторинга реализации проектов","Система оценки зрелости проектного управления"]},{title:"Риски",options:["Методология оценки и управления рисками в проектной деятельности","Наличие постоянного мониторинга, контроля и аудита в части управления рисками"]},{title:"Коммуникации",options:["Информация по проекту доступна всей проектной команде","Имеется единый архив проектных документов","Оформляются приказы об открытии проектов и утверждении проектной команды","Информация об опыте успешных и неуспешных завершённых проектов систематизирована"]},{title:"Управление изменениями и улучшениями",options:["Регламент работы с проектными инициативами","Система сбора предложений по улучшению с обратной связью","Наличие системы оценки электронной модели проекта"]},{title:"Автоматизация",options:["Ведется постоянный мониторинг проектов в информационной системе","Внедрена информационная система для управления проектами","Имеется электронный реестр проектов и проектных инициатив"]}],t=document.getElementById("questions-section"),o=document.getElementById("restart-btn"),l=0,n=Array(e.length).fill(0),s=()=>{let e="dark"===document.documentElement.dataset.theme;return{backgroundColor:e?"rgba(188, 50, 237, 0.3)":"rgba(188, 50, 237, 0.2)",borderColor:"rgba(188, 50, 237, 1)",pointBackgroundColor:"rgba(188, 50, 237, 1)",gridColor:e?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.2)",fontColor:e?"#f9fafb":"#111827"}},r=s(),a=new Chart(document.getElementById("radar-chart").getContext("2d"),{type:"radar",data:{labels:e.map(e=>({"Наличие методологии":"Методология","Формализованность бизнес-процессов":"Бизнес-процессы","Организационная структура":"Оргструктура","Контроль и аудит":"Контроль","Управление изменениями и улучшениями":["Управление","изменениями"]})[e.title]||e.title),datasets:[{label:"Уровень зрелости",data:n,backgroundColor:r.backgroundColor,borderColor:r.borderColor,borderWidth:2,pointBackgroundColor:r.pointBackgroundColor}]},options:{responsive:!0,maintainAspectRatio:!0,scales:{r:{angleLines:{color:r.gridColor},grid:{color:r.gridColor},pointLabels:{color:r.fontColor},suggestedMin:0,suggestedMax:100,ticks:{backdropColor:"transparent"}}}}});function i(t){document.querySelector(".question-block.active").classList.remove("active"),l=t,document.querySelector(`.question-block[data-section="${t+1}"]`).classList.add("active"),document.querySelectorAll(".prev-btn").forEach(e=>{e.disabled=0===t}),document.querySelectorAll(".next-btn").forEach((t,o)=>{t.textContent=o===e.length-1?"Завершить":"Далее"})}function c(){let t=document.querySelectorAll(`.question-block[data-section="${l+1}"] .selected`);n[l]=t.length/e[l].options.length*100,d()}function d(){a.data.datasets[0].data=n,a.update()}window.updateChartColors=()=>{let e=s();a.data.datasets[0].backgroundColor=e.backgroundColor,a.data.datasets[0].borderColor=e.borderColor,a.data.datasets[0].pointBackgroundColor=e.pointBackgroundColor,a.options.scales.r.angleLines.color=e.gridColor,a.options.scales.r.grid.color=e.gridColor,a.options.scales.r.pointLabels.color=e.fontColor,a.update()},o.addEventListener("click",function e(){n.fill(0),document.querySelectorAll(".option-item.selected").forEach(e=>{e.classList.remove("selected")}),l=0,i(0),d(),document.getElementById("questions-section").style.display="block",document.getElementById("result-section").style.display="none"}),e.forEach((o,s)=>{let r=document.createElement("div");r.className=`question-block card p-4 ${0===s?"active":""}`,r.dataset.section=s+1,r.innerHTML=`
        <div class="section-title fw-bold fs-5 mb-2">${o.title}</div>
        <p class="text-muted small mb-3">Укажите все пункты, наиболее точно отражающие текущий уровень развития компании. <br> В случае, если ни один из предложенных вариантов не подходит — нажмите "далее".</p>
        <ul class="options-list ps-0"></ul>
        <div class="nav-buttons d-flex justify-content-between mt-4">
          <button class="btn btn-secondary prev-btn" ${0===s?"disabled":""}>Назад</button>
          <button class="btn btn-primary next-btn">${s===e.length-1?"Завершить":"Далее"}</button>
        </div>
      `;let a=r.querySelector(".options-list");o.options.forEach(e=>{let t=document.createElement("li");t.className="option-item mb-2 p-3 rounded",t.textContent=e,t.addEventListener("click",function(){this.classList.toggle("selected")}),a.appendChild(t)});let m=r.querySelector(".prev-btn"),p=r.querySelector(".next-btn");m.addEventListener("click",()=>{l>0&&(c(),i(l-1))}),p.addEventListener("click",()=>{c(),l<e.length-1?i(l+1):function e(){let t=n.reduce((e,t)=>e+t,0)/n.length,o=document.getElementById("maturity-level"),l=document.getElementById("recommendations");t<33?(o.textContent="Низкий уровень зрелости проектного управления",o.className="text-center mb-4 text-danger",o.style.cssText="color: red !important;",l.innerHTML=`
        <h5 class="fw-bold mb-3">Рекомендации по улучшению:</h5>
        <div class="recommendation-item">
          <p>Найти функционального заказчика внедрения проектного управления в компании</p>
        </div>
        <div class="recommendation-item">
          <p>Сфокусироваться на базовых процессах (методология, роли, контроль сроков)</p>
        </div>
        <div class="recommendation-item">
          <p>Запустить пилотные проекты с жестким контролем</p>
        </div>
        <div class="recommendation-item">
          <p> <strong>Помните:</strong> важны "быстрые победы" и очевидные преимущества от внедрения проектного управления, уделите внимание поиску сотрудников, заинтересованных во внедрении изменений</p>
        </div>
      `):t<66?(o.textContent="Средний уровень зрелости проектного управления",o.className="text-center mb-4 text-warning",o.style.cssText="color: orange !important;",l.innerHTML=`
        <h5 class="fw-bold mb-3">Рекомендации по улучшению:</h5>
        <div class="recommendation-item">
          <p>Рассмотреть целесообразность осуществления проектной деятельности в информационной системе управления проектами</p>
        </div>
        <div class="recommendation-item">
          <p>На системной основе организовать обучение сотрудников основам проектного управления и работе в информационной системе управления проектами</p>
        </div>
        <div class="recommendation-item">
          <p>Автоматизировать базовые процессы проектного управления</p>
        </div>
        <div class="recommendation-item">
          <p> <strong>Важно:</strong> сфокусируйтесь на описании процессов проектного управления и имплементировании их в существующие бизнес-процессы компании</p>
        </div>
      `):(o.textContent="Высокий уровень зрелости проектного управления",o.className="text-center mb-4 text-success",o.style.cssText="color: green !important;",l.innerHTML=`
        <h5 class="fw-bold mb-3">Рекомендации по оптимизации:</h5>
        <div class="recommendation-item">
          <p>Повысить мотивацию сотрудников через внедрение механизма проектного премирования</p>
        </div>
        <div class="recommendation-item">
          <p>Углубиться в методику управления рисками и изменениями</p>
        </div>
        <div class="recommendation-item">
          <p>Изучить возможности ИИ для решения задач проектного управления</p>
        </div>
        <div class="recommendation-item">
          <p><strong>Важно:</strong> проявлять активность в экспертных сообществах по проектному управлению, изучать лучшие практики для совершенствования собственной системы</p>
        </div>
      `),document.getElementById("questions-section").style.display="none",document.getElementById("result-section").style.display="block",d()}()}),t.appendChild(r)}),document.documentElement.addEventListener("click",e=>{e.target.onclick&&e.target.onclick.toString().includes("toggleTheme")&&updateChartColors()})}),history.scrollRestoration="manual";var tooltipTriggerList=[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]')),tooltipList=tooltipTriggerList.map(function(e){return new bootstrap.Tooltip(e,{placement:"left"})});
